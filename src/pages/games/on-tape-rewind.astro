---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Navbar from '../../components/layout/Navbar.astro';
import Footer from '../../components/layout/Footer.astro';
import VHSEffect from '../../components/effects/VHSEffect.tsx';
import Badge from '../../components/ui/Badge.astro';
import SteamButton from '../../components/ui/SteamButton.astro';
import { Icon } from 'astro-icon/components';
import { games } from '../../data/games';

const game = games.find((g) => g.slug === 'on-tape-rewind')!;
const iconMap: Record<string, string> = {
  Disc3: 'lucide:disc-3',
  Search: 'lucide:search',
  AudioLines: 'lucide:audio-lines',
  Eye: 'lucide:eye',
};
---

<BaseLayout
  title="On Tape << Rewind — Pixfork Games"
  description={game.description}
>
  <Navbar />

  <main id="main-content">
    <!-- Cinematic Hero -->
    <section class="relative min-h-screen flex items-center overflow-hidden">
      <VHSEffect client:visible intensity="medium" />

      <!-- Atmospheric background -->
      <div class="absolute inset-0 bg-gradient-to-b from-bg-surface via-bg-deep to-bg-deep" aria-hidden="true"></div>

      <!-- Faint grid lines -->
      <div
        class="absolute inset-0 opacity-[0.02]"
        style="background-image: linear-gradient(var(--color-game-ontape) 1px, transparent 1px), linear-gradient(90deg, var(--color-game-ontape) 1px, transparent 1px); background-size: 64px 64px;"
        aria-hidden="true"
      ></div>

      <!-- Key art background -->
      <div class="absolute inset-0 z-[1]">
        <img
          src="/images/games/on-tape-rewind/key-art.png"
          alt=""
          class="absolute inset-0 w-full h-full object-cover opacity-30"
        />
        <div class="absolute inset-0 bg-gradient-to-b from-bg-deep/80 via-bg-deep/60 to-bg-deep"></div>
      </div>

      <div class="relative z-10 max-w-7xl mx-auto px-6 md:px-12 pt-32 pb-24 w-full">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
          <!-- Key art card -->
          <div class="relative aspect-video rounded-sm overflow-hidden shadow-[0_0_40px_rgba(78,205,196,0.15)]">
            <img
              src="/images/games/on-tape-rewind/key-art.png"
              alt="On Tape << Rewind — Key Art"
              class="absolute inset-0 w-full h-full object-cover"
            />
            <div class="vhs-overlay"></div>
          </div>

          <!-- Game info -->
          <div class="space-y-8">
            <div>
              <div class="flex items-center gap-2 mb-6">
                <span class="font-heading text-sm text-game-ontape uppercase tracking-widest">
                  Coming 2027
                </span>
                <span class="inline-block w-2 h-4 bg-game-ontape animate-[blink-cursor_1s_step-end_infinite]"></span>
              </div>

              <!-- Hand-drawn game logo -->
              <h1 class="mb-6">
                <img
                  src="/images/games/on-tape-rewind/otr-logo-white.png"
                  alt="On Tape << Rewind"
                  class="h-12 md:h-16 w-auto otr-logo-dark"
                />
                <img
                  src="/images/games/on-tape-rewind/otr-logo-black.png"
                  alt="On Tape << Rewind"
                  class="h-12 md:h-16 w-auto otr-logo-light hidden"
                />
              </h1>

              <p class="text-text-secondary text-xl leading-relaxed mb-2">
                {game.description}
              </p>
              <p class="text-game-ontape/60 text-lg italic">
                Something listened back.
              </p>
            </div>

            <!-- Genre badges -->
            <div class="flex flex-wrap gap-2">
              {game.genre.map((g) => (
                <Badge color="var(--color-game-ontape)">{g}</Badge>
              ))}
            </div>

            <!-- CTAs -->
            <div class="flex flex-wrap gap-4">
              <SteamButton />
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Features section -->
    {game.features && (
      <section class="py-24 md:py-32">
        <div class="max-w-5xl mx-auto px-6 md:px-12">
          <h2 class="font-heading text-lg text-text-primary uppercase tracking-wider text-center mb-16 neon-text-subtle">
            The Investigation
          </h2>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            {game.features.map((feature) => (
              <div class="group bg-bg-surface border border-white/5 rounded-sm p-8 hover:border-game-ontape/30 transition-all duration-300">
                <div class="w-12 h-12 bg-bg-elevated rounded-sm flex items-center justify-center mb-4 group-hover:shadow-[0_0_15px_var(--color-game-ontape)33] transition-shadow">
                  <Icon name={iconMap[feature.icon] || 'lucide:circle'} class="w-6 h-6 text-game-ontape" />
                </div>
                <h3 class="font-heading text-sm text-text-primary uppercase tracking-wider mb-3">
                  {feature.title}
                </h3>
                <p class="text-text-secondary text-sm leading-relaxed">
                  {feature.description}
                </p>
              </div>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- Trailers -->
    <section class="py-24 md:py-32 bg-bg-surface/50">
      <div class="max-w-7xl mx-auto px-6 md:px-12">
        <h2 class="font-heading text-lg text-text-primary uppercase tracking-wider text-center mb-16 neon-text-subtle">
          Trailers
        </h2>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <!-- Announcement Teaser 4K (main) -->
          <div class="lg:col-span-2">
            <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
              <iframe
                class="absolute inset-0 w-full h-full"
                src="https://www.youtube.com/embed/gH2kgX3BifY"
                title="On Tape Rewind — Announcement Teaser 4K"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                referrerpolicy="strict-origin-when-cross-origin"
                allowfullscreen
                loading="lazy"
              ></iframe>
              <div class="vhs-overlay"></div>
            </div>
            <p class="font-heading text-sm text-game-ontape/60 uppercase tracking-wider mt-3">
              Announcement Teaser — 4K
            </p>
          </div>

          <!-- Announcement Teaser (short) -->
          <div>
            <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
              <iframe
                class="absolute inset-0 w-full h-full"
                src="https://www.youtube.com/embed/RRhAFhpMeok"
                title="On Tape Rewind — Announcement Teaser"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                referrerpolicy="strict-origin-when-cross-origin"
                allowfullscreen
                loading="lazy"
              ></iframe>
              <div class="vhs-overlay"></div>
            </div>
            <p class="font-heading text-sm text-text-muted/60 uppercase tracking-wider mt-3">
              Announcement Teaser
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Characters -->
    <section class="py-24 md:py-32">
      <div class="max-w-5xl mx-auto px-6 md:px-12">
        <h2 class="font-heading text-lg text-text-primary uppercase tracking-wider text-center mb-16 neon-text-subtle">
          The People on the Tapes
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div class="group bg-bg-surface border border-white/5 rounded-sm overflow-hidden hover:border-game-ontape/30 transition-all">
            <div class="aspect-[3/4] max-h-80 overflow-hidden">
              <img
                src="/images/games/on-tape-rewind/characters/fred.png"
                alt="Fred Karlsen — The missing physicist"
                class="w-full h-full object-cover object-top group-hover:scale-105 transition-transform duration-500"
                loading="lazy"
              />
            </div>
            <div class="p-6">
              <h3 class="font-heading text-sm text-text-primary uppercase tracking-wider mb-2">Fred Karlsen</h3>
              <p class="text-text-secondary text-sm leading-relaxed">
                A brilliant physicist stationed at a remote Arctic research outpost during the Cold War. His disappearance triggered an investigation that was quickly buried — until now.
              </p>
            </div>
          </div>

          <div class="group bg-bg-surface border border-white/5 rounded-sm overflow-hidden hover:border-game-ontape/30 transition-all">
            <div class="aspect-[3/4] max-h-80 overflow-hidden">
              <img
                src="/images/games/on-tape-rewind/characters/ingrid.png"
                alt="Ingrid — A key figure in the investigation"
                class="w-full h-full object-cover object-top group-hover:scale-105 transition-transform duration-500"
                loading="lazy"
              />
            </div>
            <div class="p-6">
              <h3 class="font-heading text-sm text-text-primary uppercase tracking-wider mb-2">Ingrid</h3>
              <p class="text-text-secondary text-sm leading-relaxed">
                A central figure in the recordings. Her voice appears across multiple cassettes, weaving a thread through the mystery that connects the experiments to the disappearance.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Screenshots -->
    <section class="py-24 md:py-32 bg-bg-surface/50">
      <div class="max-w-7xl mx-auto px-6 md:px-12">
        <h2 class="font-heading text-lg text-text-primary uppercase tracking-wider text-center mb-16 neon-text-subtle">
          Screenshots
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/main-screen.jpg" alt="On Tape Rewind — Title screen with snowy landscape" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/main-screen2.jpg" alt="On Tape Rewind — Title screen at sunset" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/main-screen3.jpg" alt="On Tape Rewind — Cabin close-up with silhouette" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/screenshot-4.jpg" alt="Investigation desk with oscilloscope, tape recorder, and arctic window view" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/screenshot-5.jpg" alt="Spitsbergen map pinned to cabin wall" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/screenshot-6.jpg" alt="Cassette player with Experiment #3 tape on detective's desk" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/screenshot-7.jpg" alt="Oscilloscope and tape deck showing audio waveform analysis" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
          <div class="relative aspect-video rounded-sm overflow-hidden bg-bg-elevated">
            <img src="/images/games/on-tape-rewind/screenshot-8.jpg" alt="Field notebook with sketches and handwritten observations" class="absolute inset-0 w-full h-full object-cover" loading="lazy" />
            <div class="vhs-overlay"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Bottom CTA with Steam Deck -->
    <section class="py-24">
      <div class="max-w-5xl mx-auto px-6 md:px-12">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
          <!-- Steam Deck mockup -->
          <div class="flex justify-center">
            <img
              src="/images/games/on-tape-rewind/steamdeck-mockup.png"
              alt="On Tape Rewind running on Steam Deck"
              class="w-full max-w-md drop-shadow-[0_10px_30px_rgba(0,0,0,0.3)]"
              loading="lazy"
            />
          </div>

          <!-- CTA text -->
          <div class="text-center md:text-left">
            <h2 class="font-heading text-lg md:text-xl text-text-primary uppercase tracking-wider mb-4">
              Don't miss the investigation
            </h2>
            <p class="text-text-muted text-sm font-mono uppercase tracking-wider mb-6">
              PC &bull; Console &bull; Steam Deck
            </p>
            <p class="text-text-secondary mb-8">
              Wishlist On Tape &lt;&lt; Rewind on Steam to get notified when the game launches.
            </p>
            <SteamButton />
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</BaseLayout>
